REM Start a hidden PowerShell session at the beginning
CTRL-ESC
DELAY 500
STRING powershell -WindowStyle Hidden -NoExit -Command "$null = $host.UI.RawUI.WindowTitle='BackgroundTask'"
ENTER
DELAY 1000

REM Now your while loop sends commands to the existing session
WHILE (TRUE)
    ALT-TAB
    DELAY 100
    STRING echo 'still running' >> C:\temp\log.txt
    ENTER
    DELAY 5000
END_WHILE
